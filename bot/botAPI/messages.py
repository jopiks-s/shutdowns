import gettext
from enum import Enum

from bot.db.user import User
from config import root_path
from . import logger

default_lang = User.language_code.default
langs = ['uk', 'en']
languages = {}
for language in langs:
    languages[language] = gettext.translation('main', f'{root_path}/locales/', languages=[language])


# todo refactor
class Messages(Enum):
    start = """ÐŸÑ€Ð¸Ð²Ñ–Ñ‚ ðŸ¤™, Ñ†Ðµ Ð±Ð¾Ñ‚ Ð²Ñ–Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½ÑŒ Ð¼Ñ–ÑÑ‚Ð° ÐšÐ¸Ñ—Ð², ÑÐºÐ¸Ð¹ Ð¼Ð¾Ð¶Ðµ Ð½Ð°Ð´Ð°Ñ‚Ð¸ Ð³Ñ€Ð°Ñ„Ñ–Ðº ðŸ—“ Ñ‚Ð° Ð¿Ð¾Ð²Ñ–Ð´Ð¾Ð¼Ð»ÑÑ‚Ð¸ âš ï¸ Ð¿Ñ€Ð¾ Ð¼Ð°Ð¹Ð±ÑƒÑ‚Ð½Ñ– Ð²Ñ–Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð½ÑŽ Ñƒ Ð¼Ñ–ÑÑ‚Ñ– Ð²Ñ–Ð´Ð¿Ð¾Ð²Ñ–Ð´Ð½Ð¾ Ð´Ð¾ Ñ–Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ñ–Ñ— Ð½Ð°Ð´Ð°Ð½Ð¾Ñ— Ð½Ð° Ð¾Ñ„Ñ–Ñ†Ñ–Ð¹Ð½Ð¾Ð¼Ñƒ ÑÐ°Ð¹Ñ‚Ñ– [Ð”Ð¢Ð•Ðš](https://www.dtek-kem.com.ua/ua/shutdowns)

ðŸ‘€
Ð”Ð»Ñ Ð¿ÐµÑ€ÐµÐ³Ð»ÑÐ´Ñƒ Ð³Ñ€Ð°Ñ„Ñ–ÐºÐ° Ð²Ð¸ÐºÐ¾Ñ€Ð¸ÑÑ‚Ð¾Ð²ÑƒÐ¹Ñ‚Ðµ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñƒ /view '_Ð½Ð¾Ð¼ÐµÑ€ Ð³Ñ€ÑƒÐ¿Ð¸_', ÑÐºÑ‰Ð¾ Ð±Ð°Ð¶Ð°Ñ”Ñ‚Ðµ Ð¿ÐµÑ€ÐµÐ³Ð»ÑÐ½ÑƒÑ‚Ð¸ Ð²Ñ–Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð½Ñ Ð´Ð»Ñ ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½Ð¾Ñ— Ð³Ñ€ÑƒÐ¿Ð¸, Ð°Ð±Ð¾,  /view Ð´Ð»Ñ Ð¿ÐµÑ€ÐµÐ³Ð»ÑÐ´Ñƒ Ð²Ð»Ð°ÑÐ½Ð¾Ñ—.

Ð©Ð¾Ð± Ð¾Ñ‚Ñ€Ð¸Ð¼Ð°Ñ‚Ð¸ Ñ–Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ñ–ÑŽ Ð¿Ñ€Ð¾ ÑÐ²Ð¾Ñ— Ð½Ð°Ð»Ð°ÑˆÑ‚ÑƒÐ²Ð°Ð½Ð½Ñ Ð²Ð¸ÐºÐ¾Ñ€Ð¸ÑÑ‚Ð°Ð¹Ñ‚Ðµ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñƒ /info

âš™ï¸
Ð”Ð»Ñ Ñ‚Ð¾Ð³Ð¾, Ñ‰Ð¾Ð± Ð±Ð¾Ñ‚ Ð¿Ð¾Ñ‡Ð°Ð² Ð¿Ð¾Ð²Ñ–Ð´Ð¾Ð¼Ð»ÑÑ‚Ð¸ Ð²Ð°Ñ Ð¿Ñ€Ð¾ Ð¼Ð¾Ð¶Ð»Ð¸Ð²Ñ– Ð²Ñ–Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð½Ñ:
1. Ð—Ð°Ð¹Ð´Ñ–Ñ‚ÑŒ Ð½Ð° ÑÐ°Ð¹Ñ‚ [Ð”Ð¢Ð•Ðš](https://www.dtek-kem.com.ua/ua/shutdowns)
2. Ð”Ñ–Ð·Ð½Ð°Ð¹Ñ‚ÐµÑÑŒ ÑÐ²Ð¾ÑŽ Ð³Ñ€ÑƒÐ¿Ñƒ ÑƒÐ²Ñ–Ð²ÑˆÐ¸ Ð°Ð´Ñ€ÐµÑÑƒ Ñ‚Ð° Ð½Ð¾Ð¼ÐµÑ€ Ð´Ð¾Ð¼Ñƒ
3. Ð’Ð¸ÐºÐ¾Ñ€Ð¸ÑÑ‚Ð°Ð¹Ñ‚Ðµ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñƒ /setgroup '_Ð½Ð¾Ð¼ÐµÑ€ Ð³Ñ€ÑƒÐ¿Ð¸_'

Ð—Ð° Ð·Ð°Ð¼Ð¾Ð²Ñ‡ÑƒÐ²Ð°Ð½Ð½ÑÐ¼, Ð¿Ð¾Ð²Ñ–Ð´Ð¾Ð¼Ð»ÐµÐ½Ð½Ñ Ð±ÑƒÐ´Ðµ Ð¿Ñ€Ð¸Ñ…Ð¾Ð´Ð¸Ñ‚Ð¸ Ð·Ð° *15Ñ…Ð²* â± Ð´Ð¾ Ð²Ñ–Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð½Ñ. Ð’Ð¸ Ð¼Ð¾Ð¶ÐµÑ‚Ðµ Ð·Ð¼Ñ–Ð½Ð¸Ñ‚Ð¸ Ð½Ð°ÑÐºÑ–Ð»ÑŒÐºÐ¸ Ð·Ð°Ð²Ñ‡Ð°ÑÐ½Ð¾ Ð¿Ð¾Ð²Ñ–Ð´Ð¾Ð¼Ð»ÐµÐ½Ð½Ñ Ð±ÑƒÐ´ÑƒÑ‚ÑŒ Ð¿Ñ€Ð¸Ñ…Ð¾Ð´Ð¸Ñ‚Ð¸ ÐºÐ¾Ð¼Ð°Ð½Ð´Ð¾ÑŽ /notification\_advance '_ÐºÑ–Ð»ÑŒÐºÑ–ÑÑ‚ÑŒ Ñ…Ð²Ð¸Ð»Ð¸Ð½_'

ðŸš«ðŸš«ðŸš«
Ð¯ÐºÑ‰Ð¾ Ð²Ð¸ Ð±Ñ–Ð»ÑŒÑˆÐµ Ð½Ðµ Ð±Ð°Ð¶Ð°Ñ”Ñ‚Ðµ Ð¾Ñ‚Ñ€Ð¸Ð¼ÑƒÐ²Ð°Ñ‚Ð¸ Ð½Ð°Ð³Ð°Ð´ÑƒÐ²Ð°Ð½Ð½Ñ, Ð²Ð¸ Ð¼Ð¾Ð¶ÐµÑ‚Ðµ  Ð²Ð¸Ð¼ÐºÐ½ÑƒÑ‚Ð¸ Ð¿Ð¾Ð²Ñ–Ð´Ð¾Ð¼Ð»ÐµÐ½Ð½Ñ Ð°Ð±Ð¾ Ð·ÑƒÐ¿Ð¸Ð½Ð¸Ñ‚Ð¸ Ð±Ð¾Ñ‚Ð°.

Ð¡Ð¿Ð¸ÑÐ¾Ðº ÐºÐ¾Ð¼Ð°Ð½Ð´ Ð´Ð»Ñ Ð²Ð·Ð°Ñ”Ð¼Ð¾Ð´Ñ–Ñ— Ð· Ð±Ð¾Ñ‚Ð¾Ð¼ðŸ™ƒ
/start - Ð·Ð°Ð¿ÑƒÑÐº Ð±Ð¾Ñ‚Ð°
/view ('_Ð½Ð¾Ð¼ÐµÑ€ Ð³Ñ€ÑƒÐ¿Ð¸_') - Ð¿ÐµÑ€ÐµÐ³Ð»ÑÐ´ Ð³Ñ€Ð°Ñ„Ñ–ÐºÑƒ Ð²Ñ–Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½ÑŒ Ð·Ð° Ð²Ð°ÑˆÐ¾ÑŽ Ð³Ñ€ÑƒÐ¿Ð¾ÑŽ Ð°Ð±Ð¾ Ð²ÐºÐ°Ð·Ð°Ð½Ð¸Ð¼ Ð½Ð¾Ð¼ÐµÑ€Ð¾Ð¼
/setgroup '_Ð½Ð¾Ð¼ÐµÑ€ Ð³Ñ€ÑƒÐ¿Ð¸_' - Ð²ÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð½Ñ Ð²Ð°ÑˆÐ¾Ñ— Ð³Ñ€ÑƒÐ¿Ð¸
/notification\_advance '_ÐºÑ–Ð»ÑŒÐºÑ–ÑÑ‚ÑŒ Ñ…Ð²Ð¸Ð»Ð¸Ð½_' - Ð²ÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð½Ñ Ð·Ð° ÑÐºÑ–Ð»ÑŒÐºÐ¸ Ð´Ð¾ Ð²Ñ–Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð½Ñ Ð²Ð°Ñ Ð¿Ð¾Ð²Ñ–Ð´Ð¾Ð¼Ð»ÑÑ‚Ð¸ (Ñ…Ð²).
/info - Ð¿ÐµÑ€ÐµÐ³Ð»ÑÐ´ Ð½Ð°Ð»Ð°ÑˆÑ‚ÑƒÐ²Ð°Ð½ÑŒ"""

    view_success = 'Ð“Ñ€ÑƒÐ¿Ð° {group}'
    view_failure_group = """Ð©Ð¾Ð± Ð¿Ð¾Ð´Ð¸Ð²Ð¸Ñ‚Ð¸ÑÑ Ñ€Ð¾Ð·ÐºÐ»Ð°Ð´ ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½Ð¾Ñ— Ð³Ñ€ÑƒÐ¿Ð¸
/view '_Ð½Ð¾Ð¼ÐµÑ€ Ð³Ñ€ÑƒÐ¿Ð¸_'.
Ð’Ð¸ Ð½Ðµ Ð²ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ð»Ð¸ Ð½Ð¾Ð¼ÐµÑ€ ÑÐ²Ð¾Ñ”Ñ— Ð³Ñ€ÑƒÐ¿Ð¸, Ñ‰Ð¾Ð± Ñ†Ðµ Ð·Ñ€Ð¾Ð±Ð¸Ñ‚Ð¸ ðŸ‘‡"""
    view_failure_param = """/view ('_Ð½Ð¾Ð¼ÐµÑ€ Ð³Ñ€ÑƒÐ¿Ð¸_') - Ð¿ÐµÑ€ÐµÐ³Ð»ÑÐ´ Ð³Ñ€Ð°Ñ„Ñ–ÐºÑƒ Ð²Ñ–Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½ÑŒ Ð·Ð° Ð²Ð°ÑˆÐ¾ÑŽ Ð³Ñ€ÑƒÐ¿Ð¾ÑŽ Ð°Ð±Ð¾ Ð²ÐºÐ°Ð·Ð°Ð½Ð¸Ð¼ Ð½Ð¾Ð¼ÐµÑ€Ð¾Ð¼.
'_ÐÐ¾Ð¼ÐµÑ€ Ð³Ñ€ÑƒÐ¿Ð¸_' Ñ‡Ð¸ÑÐ»Ð¾ Ð²Ñ–Ð´ 1 Ð´Ð¾ 3.
/view âœ… # _Ð’Ñ–Ð´Ð¾Ð±Ñ€Ð°Ð·Ð¸Ñ‚Ð¸ Ð·Ð° Ð²Ð°ÑˆÐ¾ÑŽ Ð³Ñ€ÑƒÐ¿Ð¾ÑŽ_
/view 1 âœ… # _Ð’Ñ–Ð´Ð¾Ð±Ñ€Ð°Ð·Ð¸Ñ‚Ð¸ 1 Ð³Ñ€ÑƒÐ¿Ñƒ_
/view 10 ðŸš«"""

    setgroup = """/setgroup '_Ð½Ð¾Ð¼ÐµÑ€ Ð³Ñ€ÑƒÐ¿Ð¸_' - Ð²ÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð½Ñ Ð²Ð°ÑˆÐ¾Ñ— Ð³Ñ€ÑƒÐ¿Ð¸.
'_ÐÐ¾Ð¼ÐµÑ€ Ð³Ñ€ÑƒÐ¿Ð¸_' Ñ‡Ð¸ÑÐ»Ð¾ Ð²Ñ–Ð´ 1 Ð´Ð¾ 3.
/setgroup 1 âœ…
/setgroup 10 ðŸš«"""
    setgroup_success = 'Ð“Ñ€ÑƒÐ¿Ñƒ ÑƒÑÐ¿Ñ–ÑˆÐ½Ð¾ Ð·Ð¼Ñ–Ð½ÐµÐ½Ð¾! âœ…'
    setgroup_failure = 'ÐÐµ Ð²Ð´Ð°Ð»Ð¾ÑÑ Ð·Ð¼Ñ–Ð½Ð¸Ñ‚Ð¸ Ð³Ñ€ÑƒÐ¿Ñƒ :( ðŸš«'

    notification_advance = """/notification\_advance '_ÐºÑ–Ð»ÑŒÐºÑ–ÑÑ‚ÑŒ Ñ…Ð²Ð¸Ð»Ð¸Ð½_' - Ð²ÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð½Ñ Ð·Ð° ÑÐºÑ–Ð»ÑŒÐºÐ¸ Ð´Ð¾ Ð²Ñ–Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð½Ñ Ð²Ð°Ñ Ð¿Ð¾Ð²Ñ–Ð´Ð¾Ð¼Ð»ÑÑ‚Ð¸.
'_ÐšÑ–Ð»ÑŒÐºÑ–ÑÑ‚ÑŒ Ñ…Ð²Ð¸Ð»Ð¸Ð½_' - Ð·ÑÑƒÐ² Ð²Ñ–Ð´ *0Ñ…Ð²* Ð´Ð¾ *1 Ð´Ð¾Ð±Ð¸* (_1440Ñ…Ð²_).
/notification\_advance 25 âœ… # _Ð—Ð° 25Ñ…Ð² Ð´Ð¾ Ð²Ñ–Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½ÑŒ_
/notification\_advance 1441 ðŸš«"""
    notification_advance_success = 'Ð§Ð°Ñ ÑƒÑÐ¿Ñ–ÑˆÐ½Ð¾ Ð·Ð¼Ñ–Ð½ÐµÐ½Ð¾! âœ…'
    notification_advance_failure = 'ÐÐµ Ð²Ð´Ð°Ð»Ð¾ÑÑ Ð·Ð¼Ñ–Ð½Ð¸Ñ‚Ð¸ Ñ‡Ð°Ñ Ð¿Ð¾Ð²Ñ–Ð´Ð¾Ð¼Ð»ÐµÐ½ÑŒ :( ðŸš«'

    info_set = 'Ð“Ñ€ÑƒÐ¿Ð° {group}. ÐŸÐ¾Ð²Ñ–Ð´Ð¾Ð¼Ð»ÐµÐ½Ð½Ñ Ð·Ð° {notification_advance}Ñ…Ð² Ð´Ð¾ Ð²Ñ–Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð½Ñ.'
    info_unset = 'Ð“Ñ€ÑƒÐ¿Ð° Ð½Ðµ Ð²ÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð°. Ð©Ð¾Ð± Ñ†Ðµ Ð·Ñ€Ð¾Ð±Ð¸Ñ‚Ð¸ðŸ‘‡'


# todo lock, dude :)
def get_translation(msgs: tuple[Messages] | Messages, language_code: str, **kwargs) -> str:
    if language_code in languages:
        languages[language_code].install()
        logger.debug(f'Installed language: {language_code}')
    else:
        languages[default_lang].install()
        logger.debug(f'Didn`t find language: {language_code}\n'
                     f'Installed default: {default_lang}')

    if isinstance(msgs, tuple):
        text = '\n'.join([_(msg.value) for msg in msgs])
        text = text.format(**kwargs)
    else:
        text = _(msgs.value).format(**kwargs)

    return text
